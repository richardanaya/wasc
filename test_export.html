<!DOCTYPE html>
<html>
<head>
    <title>WASM Test - Exported Function</title>
</head>
<body>
    <h1>WASM Test Results</h1>
    <div id="result">Loading...</div>
    <script>
        async function loadWasm() {
            try {
                const response = await fetch('test_export.wasm');
                const bytes = await response.arrayBuffer();
                const module = await WebAssembly.compile(bytes);
                
                console.log('Exports:', WebAssembly.Module.exports(module));
                
                const instance = await WebAssembly.instantiate(module, {
                    env: {}
                });
                
                console.log('Instance exports:', Object.keys(instance.exports));
                
                if (instance.exports.main) {
                    const result = instance.exports.main();
                    document.getElementById('result').textContent = 
                        'SUCCESS: main() returned ' + result;
                } else {
                    document.getElementById('result').textContent = 
                        'ERROR: main export not found. Available: ' + Object.keys(instance.exports).join(', ');
                }
            } catch (e) {
                document.getElementById('result').textContent = 
                    'ERROR: ' + e.message;
                console.error(e);
            }
        }
        loadWasm();
    </script>
</body>
</html>
